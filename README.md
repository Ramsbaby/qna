![Java_8](https://img.shields.io/badge/java-v1.8-red?logo=java)
![Spring_Boot](https://img.shields.io/badge/Spring_Boot-v2.4.0-green.svg?logo=spring)

# Qna Service REST API


## 프로젝트 소개
고객 문의 접수 및 답변 기능 개발

## Feature
* Java 8
* Sprint boot 2.4.0
* gradle 6.7
* React.js, ES6
* JPA, h2
* Spring Rest Docs

### 기능
1. 고객-문의글 등록
2. 고객-문의글 확인
3. 고객-상담사 답변 확인
4. 상담사-회원가입
5. 상담사-로그인
6. 상담사-문의글 확인
7. 상담사-문의글 선택
8. 상담사-답변 등록
9. Qna 히스토리 확인

## 실행방법
* build
```cmd
./gradlew clean bootJar
```
* run(default port:8000)
```cmd
java -jar build/libs/qna-0.0.1-SNAPSHOT.jar
```

## API Document(after running)
```cmd
http://localhost:8000/docs/index.html
```

## 문제 해결 전략
### 1. 고객-문의글 등록
```
고객은 회원가입 없이 고객 전용 페이지에서
'유저ID', 제목, 내용을 작성할 수 있다.
```
### 2. 고객-문의글 확인
```
고객은 로그인과정이 없기 때문에, 고객 전용 페이지에서
별도의 검색(유저아이디)기능을 통해 
본인의 문의글 목록과 상담사의 답변을 확인 할 수 있다.
```
### 3. 상담사-답변 확인
```
고객은 본인 문의글에 등록된 상담사의 답변을 확인할 수 있다.
```
### 4. 상담사-회원가입
```
상담사는 로그인과정이 필요하기 때문에 회원가입이 필요하다.
가입하기 위해서는 유저ID를 중복체크한다.
(비밀번호는 자바에서 제공하는 Base64 라이브러리를 이용하여
암/복호화 처리함.)
```
### 5. 상담사-로그인/로그아웃
```
상담사는 로그인페이지에서 회원가입을 한 후,
로그인을 통해 상담사전용페이지로 이동할 수 있다.
로그인상태는 브라우저의 LocalStorage를 통해 유지함.
로그아웃 시 LocalStorage에서 유저데이터 삭제함.
```
### 6. 상담사-문의글 목록 확인
```
상담사는 로그인 후, 상담사 전용 페이지에서 
답변이 등록되지 않은 문의글들을 확인할 수 있다.
프론트엔드에서 10초마다 문의글목록을 재확인 할 수 있는 
폴링기능을 적용함.
```
### 7. 상담사-문의글 선택
```
상담사는 지정상담사가 등록되지 않은 문의글의 지정상담사를
본인으로 지정할 수 있다.
지정상담사가 등록되어 있으면, 본인으로 지정할 수 없다.
혹여 발생할 동시성 이슈에 대해 비관적인 동시성제어 방법인
Lock을 통해 이슈에 대응함.
```
### 8. 상담사-답변 등록
```
상담사는 본인으로 지정상담사를 지정한 문의글에 대해
답변을 등록할 수 있다.
답변 등록 시, 상담사전용페이지에서 더 이상 확인할 수 없으며,
고객은 확인 가능하다.
```
### 9. 전체 히스토리 확인
```
고객과 상담사의 히스토리 내역을 전체 히스토리 페이지에서 확인할 수 있다.
JPA Entity Listener를 통해 공통로직으로 구현함.
```

